import * as XLSX from 'xlsx'

/**
 * 샘플 엑셀 파일 생성
 */
export const createSampleExcel = () => {
  // 샘플 데이터
  const sampleData = [
    {
      날짜: '2025-01-15',
      설명: '월급',
      계정과목: '급여수입',
      수입: 3000000,
      지출: '',
    },
    {
      날짜: '2025-01-16',
      설명: '식비',
      계정과목: '식비',
      수입: '',
      지출: 15000,
    },
    {
      날짜: '2025-01-17',
      설명: '교통비',
      계정과목: '교통비',
      수입: '',
      지출: 5000,
    },
    {
      날짜: '2025-01-18',
      설명: '부수입',
      계정과목: '기타수입',
      수입: 500000,
      지출: '',
    },
    {
      날짜: '2025-01-20',
      설명: '생활비',
      계정과목: '생활비',
      수입: '',
      지출: 200000,
    },
    {
      날짜: '2025-01-22',
      설명: '의료비',
      계정과목: '의료비',
      수입: '',
      지출: 50000,
    },
    {
      날짜: '2025-01-25',
      설명: '프리랜스 수입',
      계정과목: '사업수입',
      수입: 800000,
      지출: '',
    },
    {
      날짜: '2025-01-28',
      설명: '통신비',
      계정과목: '통신비',
      수입: '',
      지출: 30000,
    },
  ]

  // 워크북 생성
  const wb = XLSX.utils.book_new()
  const ws = XLSX.utils.json_to_sheet(sampleData)

  // 컬럼 너비 설정
  ws['!cols'] = [
    { wch: 12 }, // 날짜
    { wch: 20 }, // 설명
    { wch: 15 }, // 계정과목
    { wch: 15 }, // 수입
    { wch: 15 }, // 지출
  ]

  // 워크시트 추가
  XLSX.utils.book_append_sheet(wb, ws, '거래내역')

  // 파일 다운로드
  XLSX.writeFile(wb, '거래내역_샘플.xlsx')
}
